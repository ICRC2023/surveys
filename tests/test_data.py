"""Test config.Data class"""

from titanite import config

CONFIG_DIVERSITY = "../sandbox/config.toml"
DATA_DIVERSITY = "../data/test_data/prepared_data.csv"


def test_data_read():
    d = config.Data(read_from=DATA_DIVERSITY, load_from=CONFIG_DIVERSITY)
    data = d.read()

    test_cases = {
        len(data): 295,
        len(data.columns): 58,
    }

    for k, v in test_cases.items():
        assert k == v


def test_data_headers():
    c = config.Config(load_from=CONFIG_DIVERSITY)
    c.load()

    d = config.Data(read_from=DATA_DIVERSITY, load_from=CONFIG_DIVERSITY)
    data = d.read()

    headers = list(data.columns)
    rr = c.get_roundrobin_headers(headers)

    expected = [
        ("q01", "q02"),
        ("q01", "q03"),
        ("q01", "q03_regional"),
        ("q01", "q03_subregional"),
        ("q01", "q04"),
        ("q01", "q04_regional"),
        ("q01", "q04_subregional"),
        ("q01", "q05"),
        ("q01", "q06"),
        ("q01", "q07"),
        ("q01", "q08"),
        ("q01", "q09"),
        ("q01", "q11"),
        ("q01", "q12_diversity"),
        ("q01", "q12_equity"),
        ("q01", "q12_genderbalance"),
        ("q01", "q12_inclusion"),
        ("q01", "q14"),
        ("q01", "q17_diversity"),
        ("q01", "q17_equity"),
        ("q01", "q17_genderbalance"),
        ("q01", "q17_inclusion"),
        ("q01", "q19"),
        ("q02", "q03"),
        ("q02", "q03_regional"),
        ("q02", "q03_subregional"),
        ("q02", "q04"),
        ("q02", "q04_regional"),
        ("q02", "q04_subregional"),
        ("q02", "q05"),
        ("q02", "q06"),
        ("q02", "q07"),
        ("q02", "q08"),
        ("q02", "q09"),
        ("q02", "q11"),
        ("q02", "q12_diversity"),
        ("q02", "q12_equity"),
        ("q02", "q12_genderbalance"),
        ("q02", "q12_inclusion"),
        ("q02", "q14"),
        ("q02", "q17_diversity"),
        ("q02", "q17_equity"),
        ("q02", "q17_genderbalance"),
        ("q02", "q17_inclusion"),
        ("q02", "q19"),
        ("q03", "q03_regional"),
        ("q03", "q03_subregional"),
        ("q03", "q04"),
        ("q03", "q04_regional"),
        ("q03", "q04_subregional"),
        ("q03", "q05"),
        ("q03", "q06"),
        ("q03", "q07"),
        ("q03", "q08"),
        ("q03", "q09"),
        ("q03", "q11"),
        ("q03", "q12_diversity"),
        ("q03", "q12_equity"),
        ("q03", "q12_genderbalance"),
        ("q03", "q12_inclusion"),
        ("q03", "q14"),
        ("q03", "q17_diversity"),
        ("q03", "q17_equity"),
        ("q03", "q17_genderbalance"),
        ("q03", "q17_inclusion"),
        ("q03", "q19"),
        ("q03_regional", "q03_subregional"),
        ("q03_regional", "q04"),
        ("q03_regional", "q04_regional"),
        ("q03_regional", "q04_subregional"),
        ("q03_regional", "q05"),
        ("q03_regional", "q06"),
        ("q03_regional", "q07"),
        ("q03_regional", "q08"),
        ("q03_regional", "q09"),
        ("q03_regional", "q11"),
        ("q03_regional", "q12_diversity"),
        ("q03_regional", "q12_equity"),
        ("q03_regional", "q12_genderbalance"),
        ("q03_regional", "q12_inclusion"),
        ("q03_regional", "q14"),
        ("q03_regional", "q17_diversity"),
        ("q03_regional", "q17_equity"),
        ("q03_regional", "q17_genderbalance"),
        ("q03_regional", "q17_inclusion"),
        ("q03_regional", "q19"),
        ("q03_subregional", "q04"),
        ("q03_subregional", "q04_regional"),
        ("q03_subregional", "q04_subregional"),
        ("q03_subregional", "q05"),
        ("q03_subregional", "q06"),
        ("q03_subregional", "q07"),
        ("q03_subregional", "q08"),
        ("q03_subregional", "q09"),
        ("q03_subregional", "q11"),
        ("q03_subregional", "q12_diversity"),
        ("q03_subregional", "q12_equity"),
        ("q03_subregional", "q12_genderbalance"),
        ("q03_subregional", "q12_inclusion"),
        ("q03_subregional", "q14"),
        ("q03_subregional", "q17_diversity"),
        ("q03_subregional", "q17_equity"),
        ("q03_subregional", "q17_genderbalance"),
        ("q03_subregional", "q17_inclusion"),
        ("q03_subregional", "q19"),
        ("q04", "q04_regional"),
        ("q04", "q04_subregional"),
        ("q04", "q05"),
        ("q04", "q06"),
        ("q04", "q07"),
        ("q04", "q08"),
        ("q04", "q09"),
        ("q04", "q11"),
        ("q04", "q12_diversity"),
        ("q04", "q12_equity"),
        ("q04", "q12_genderbalance"),
        ("q04", "q12_inclusion"),
        ("q04", "q14"),
        ("q04", "q17_diversity"),
        ("q04", "q17_equity"),
        ("q04", "q17_genderbalance"),
        ("q04", "q17_inclusion"),
        ("q04", "q19"),
        ("q04_regional", "q04_subregional"),
        ("q04_regional", "q05"),
        ("q04_regional", "q06"),
        ("q04_regional", "q07"),
        ("q04_regional", "q08"),
        ("q04_regional", "q09"),
        ("q04_regional", "q11"),
        ("q04_regional", "q12_diversity"),
        ("q04_regional", "q12_equity"),
        ("q04_regional", "q12_genderbalance"),
        ("q04_regional", "q12_inclusion"),
        ("q04_regional", "q14"),
        ("q04_regional", "q17_diversity"),
        ("q04_regional", "q17_equity"),
        ("q04_regional", "q17_genderbalance"),
        ("q04_regional", "q17_inclusion"),
        ("q04_regional", "q19"),
        ("q04_subregional", "q05"),
        ("q04_subregional", "q06"),
        ("q04_subregional", "q07"),
        ("q04_subregional", "q08"),
        ("q04_subregional", "q09"),
        ("q04_subregional", "q11"),
        ("q04_subregional", "q12_diversity"),
        ("q04_subregional", "q12_equity"),
        ("q04_subregional", "q12_genderbalance"),
        ("q04_subregional", "q12_inclusion"),
        ("q04_subregional", "q14"),
        ("q04_subregional", "q17_diversity"),
        ("q04_subregional", "q17_equity"),
        ("q04_subregional", "q17_genderbalance"),
        ("q04_subregional", "q17_inclusion"),
        ("q04_subregional", "q19"),
        ("q05", "q06"),
        ("q05", "q07"),
        ("q05", "q08"),
        ("q05", "q09"),
        ("q05", "q11"),
        ("q05", "q12_diversity"),
        ("q05", "q12_equity"),
        ("q05", "q12_genderbalance"),
        ("q05", "q12_inclusion"),
        ("q05", "q14"),
        ("q05", "q17_diversity"),
        ("q05", "q17_equity"),
        ("q05", "q17_genderbalance"),
        ("q05", "q17_inclusion"),
        ("q05", "q19"),
        ("q06", "q07"),
        ("q06", "q08"),
        ("q06", "q09"),
        ("q06", "q11"),
        ("q06", "q12_diversity"),
        ("q06", "q12_equity"),
        ("q06", "q12_genderbalance"),
        ("q06", "q12_inclusion"),
        ("q06", "q14"),
        ("q06", "q17_diversity"),
        ("q06", "q17_equity"),
        ("q06", "q17_genderbalance"),
        ("q06", "q17_inclusion"),
        ("q06", "q19"),
        ("q07", "q08"),
        ("q07", "q09"),
        ("q07", "q11"),
        ("q07", "q12_diversity"),
        ("q07", "q12_equity"),
        ("q07", "q12_genderbalance"),
        ("q07", "q12_inclusion"),
        ("q07", "q14"),
        ("q07", "q17_diversity"),
        ("q07", "q17_equity"),
        ("q07", "q17_genderbalance"),
        ("q07", "q17_inclusion"),
        ("q07", "q19"),
        ("q08", "q09"),
        ("q08", "q11"),
        ("q08", "q12_diversity"),
        ("q08", "q12_equity"),
        ("q08", "q12_genderbalance"),
        ("q08", "q12_inclusion"),
        ("q08", "q14"),
        ("q08", "q17_diversity"),
        ("q08", "q17_equity"),
        ("q08", "q17_genderbalance"),
        ("q08", "q17_inclusion"),
        ("q08", "q19"),
        ("q09", "q11"),
        ("q09", "q12_diversity"),
        ("q09", "q12_equity"),
        ("q09", "q12_genderbalance"),
        ("q09", "q12_inclusion"),
        ("q09", "q14"),
        ("q09", "q17_diversity"),
        ("q09", "q17_equity"),
        ("q09", "q17_genderbalance"),
        ("q09", "q17_inclusion"),
        ("q09", "q19"),
        ("q11", "q12_diversity"),
        ("q11", "q12_equity"),
        ("q11", "q12_genderbalance"),
        ("q11", "q12_inclusion"),
        ("q11", "q14"),
        ("q11", "q17_diversity"),
        ("q11", "q17_equity"),
        ("q11", "q17_genderbalance"),
        ("q11", "q17_inclusion"),
        ("q11", "q19"),
        ("q12_diversity", "q12_equity"),
        ("q12_diversity", "q12_genderbalance"),
        ("q12_diversity", "q12_inclusion"),
        ("q12_diversity", "q14"),
        ("q12_diversity", "q17_diversity"),
        ("q12_diversity", "q17_equity"),
        ("q12_diversity", "q17_genderbalance"),
        ("q12_diversity", "q17_inclusion"),
        ("q12_diversity", "q19"),
        ("q12_equity", "q12_genderbalance"),
        ("q12_equity", "q12_inclusion"),
        ("q12_equity", "q14"),
        ("q12_equity", "q17_diversity"),
        ("q12_equity", "q17_equity"),
        ("q12_equity", "q17_genderbalance"),
        ("q12_equity", "q17_inclusion"),
        ("q12_equity", "q19"),
        ("q12_genderbalance", "q12_inclusion"),
        ("q12_genderbalance", "q14"),
        ("q12_genderbalance", "q17_diversity"),
        ("q12_genderbalance", "q17_equity"),
        ("q12_genderbalance", "q17_genderbalance"),
        ("q12_genderbalance", "q17_inclusion"),
        ("q12_genderbalance", "q19"),
        ("q12_inclusion", "q14"),
        ("q12_inclusion", "q17_diversity"),
        ("q12_inclusion", "q17_equity"),
        ("q12_inclusion", "q17_genderbalance"),
        ("q12_inclusion", "q17_inclusion"),
        ("q12_inclusion", "q19"),
        ("q14", "q17_diversity"),
        ("q14", "q17_equity"),
        ("q14", "q17_genderbalance"),
        ("q14", "q17_inclusion"),
        ("q14", "q19"),
        ("q17_diversity", "q17_equity"),
        ("q17_diversity", "q17_genderbalance"),
        ("q17_diversity", "q17_inclusion"),
        ("q17_diversity", "q19"),
        ("q17_equity", "q17_genderbalance"),
        ("q17_equity", "q17_inclusion"),
        ("q17_equity", "q19"),
        ("q17_genderbalance", "q17_inclusion"),
        ("q17_genderbalance", "q19"),
        ("q17_inclusion", "q19"),
    ]

    assert rr == expected
